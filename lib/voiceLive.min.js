/* voiceLive 1.0.0 Copyright (c) 2016 "Lzwai" | Licensed under the MIT license. | see:  for details */
!function(a,b){"function"==typeof define&&define.amd?define(["howler"],b):"object"==typeof exports?module.exports=b(require("howler")):a.VoiceLive=b(Howl)}(this,function(a){"use strict";a=a.Howl||a;var b=function(){},c=function(a){for(var b={},c=0,d=a.length;c<d;c++){var e=a[c];b[e.id]=e}return b},d=function(a){return"[object Array]"===Object.prototype.toString.call(a).indexOf("Array")},e=function(a){this._init(a)};return e.prototype={_init:function(a){if(!a)throw new Error("options is wrong!");if(d(a.datas))throw new Error("datas must be array");this.curItemId="",this.curItemIndex="",this.step=a.step||b,this.events=a.events||{},this.originLists=a.datas,this.playLists=c(a.datas)},_getCurItemIndex:function(a){for(var b=0,c=this.originLists.length;b<c;b++){var d=this.originLists[b];if(d.id.toString()===a.toString())return b}},_step:function(a){var b=this.playLists[a],c=b&&b.howl;if(c&&c.playing()){var d=c.seek(),e=c.duration();this.step(a,d,d/e),window.requestAnimationFrame(this._step.bind(this,a))}},addVoice:function(a){return this.originLists.push(a),this.playLists[a.id]=a,this},play:function(b){var c=this,d=this.playLists[b],e=this.events,f=d.howl;if(f){if(f.playing())return}else f=new a({src:d.src,volume:1,onload:function(){e.onload&&e.onload.call(c)},onloaderror:function(){e.onloaderror&&e.onloaderror.call(c)},onplay:function(){window.requestAnimationFrame(c._step.bind(c,b)),e.onplay&&e.onplay.call(c)},onpause:function(){e.onpause&&e.onpause.call(c)},onstop:function(){e.onstop&&e.onstop.call(c)},onend:function(){e.onend&&e.onend.call(c)}});return this.pause(this.curItemId),f.play(),this.playLists[b].howl=f,this.curItemId=d.id,this.curItemIndex=this._getCurItemIndex(b),this},pause:function(a){var b=this.playLists[a],c=b&&b.howl;return c&&(this.curItemId="",c.pause(),this.playLists[a].currentTime=c.duration()),this},stop:function(a){var b=this.playLists[a],c=b&&b.howl;return c&&(this.curItemId="",c.stop(),this.playLists[a].currentTime=0),this},playNext:function(){if(""!==this.curItemIndex){var a=this.originLists[++this.curItemIndex];a&&this.play(a.id)}},playPre:function(){if(""!==this.curItemIndex){var a=this.originLists[--this.curItemIndex];a&&this.play(a.id)}}},e});